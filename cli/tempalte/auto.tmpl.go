// Copyright (c) 2018-2020 Double All rights reserved.
// Use of this source code is governed by a MIT style
// license that can be found in the LICENSE file.

package tempalte

// TmplAuto defined template
var TmplAuto = `// Code generated by dol build. DO NOT EDIT.
// source: auto.go

package app

import (
	"{{.PackageName}}/model"

	"github.com/2637309949/dolphin/srv/cli"
)

// Sync models
var _ = cli.Invoke(BuildEngine(func(e *Engine) {
	{{- range .Tables}}
	e.MSets.Add(new(model.{{.ToUpperCase .Name}}))
	{{- end}}
}))
{{range .Controllers}}
// Build{{.ToUpperCase .Name}}
var _ = cli.Invoke(Build{{.ToUpperCase .Name}}(func(ctr *{{.ToUpperCase .Name}}) {
	group := ctr.Group("/api")
	{{- $ctr := .}}
	{{- range .APIS}}
	group.Handle("{{.ToUpper .Method}}", "{{.Version}}/{{$ctr.Name}}/{{.Name}}", ctr.{{.ToUpperCase .Name}})
	{{- end}}
}))
{{- end}}

// StartUp booting system
var _ = cli.Invoke(BuildEngine(func(e *Engine) {
	e.StartUp()
}))
`
